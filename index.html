<!DOCTYPE html>
<html>
<head>
  <title>Inventory Checkout Form</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 2rem;
    }
    .product-group {
      border: 1px solid #ccc;
      padding: 1rem;
      margin-bottom: 1rem;
    }
    label {
      display: block;
      margin-top: 0.5rem;
    }
  </style>
</head>
<body>
  <h2>Inventory Checkout Form</h2>
  <form id="checkout-form">
    <div id="product-list"></div>

    <button type="button" onclick="addProduct()">Add Product</button>
    <br><br>

    <label>Location:
      <select name="location" required>
        <option value="Trailer">Trailer</option>
        <option value="Warehouse">Warehouse</option>
        <option value="Alec">Alec</option>
        <option value="Master">Master</option>
      </select>
    </label>

    <label>Job / Customer Name:
      <input type="text" name="customer" required>
    </label>

    <label>Technician Name:
      <input type="text" name="technician" required>
    </label>

    <br>
    <button type="submit">Submit</button>
  </form>

  <script>
    const productCount = [
"4004876-9 Local CANBUS Ext 9 ft",
"4004876-2 Local CANBUS Ext 2 ft",
"4004876-12 Local CANBUS Ext 12 ft",
"4006167 PCM2 I/O Cable",
"4005945 RCM2 Row to Row Harness",
"4006224 RCM2 Surespeed cable",
"4001450-12 High Current Power Extension 12ft",
"4004902-8 Downforce Pressure Transducer Cable",
"4006191 RCM2 I/O Speed Sensor and Clutch",
"4004993-6 Pressure Sensor Ext Downforce",
"4006190-2 Suredrive RCM2",
"2012000035 Seed Tube Sensors",
"g10177501 Corn Ejectors",
"g10177601 Soybean Ejectors",
"4006288 JD ME Seedtube Guards",
"4006330 JD/ HI mini hopper mount",
"4002941 SureVac Rub Pad",
"SureVac Seal",
"4001450-2 High Current Power Extension 2ft",
"4005187 Planter control I/O cable",
"4001517-19 Wheel Motion Sensor Cable 19ft",
"Split sprockets",
"4002142-20 CNH Hyd Seed Control",
"4001796-20 Planter Extension 20ft",
"4001087-16 Clutch Extension Cable 16ft",
"4001086-3 Air Clutch Control Cable 3ft",
"4001086-16 Air Clutch Extension Cable 16ft",
"4001087-25 Air Clutch Extension Cable 25ft",
"4001013 High Current Power Splitter",
"4001779 16r 2 row section clutch breakout",
"4001925-6 Rowcommand clutch adapter 16/24r",
"4001085-6 Clutch extension 6ft",
"4001020-3 Tru-count clutch cable",
"4002151-1 Rowcommand 2 pin adapter",
"4001042-25 Clutch Extension 25 ft - modified to 10 ft",
"Bearing Hanger Spacers",
"4001042-16 Clutch Solenoid cable",
"4002978 Pressure Sensor Cable (3 inputs)",
"4003610-6 Pressure Sensor cable agleader 6 ft",
"4000495-1 Implement Plug",
"4001266 Raven Adapter Harness (7 Sections)",
"400451-6 Raven Flow/Control",
"4000424 7 Section Boom Harness",
"4000527 OEM Switch Harness",
"Hi Current Power Splitter",
"4000529-12 Channel Extensions 12ft",
"4000528-12 Boom Extension",
"4003980-6 Aux Valve Cable",
"4001103-4 SPX Cable Harness 4 ft",
"4001368-4 SPX Switch Input",
"4000310-1 App Rate I/O Cable",
"4002477 Krohne IFC 100",
"4001808-18 CAN/Power Combo extension",
"4006656-002 L2 Local Breakout",
"4007041 Miller Fence Row",
"4005207-006 Hagie AWS disable relay",
"4007708-15 L2 flow/control Rogator 2009",
"4001370-9 Pump Swtich Cable only",
"4001810-5 SPX Bulk Head Tee",
"Fence Row Adapter",
"4006667 L2 Module Mounting Bracket",
"4001808-6 CAN/Power Combo extension",
"116500-014 Orifice Insert O-ring",
"116500-013 Spoke O-ring Service kit",
"116500-008 2 Slot Plunger Service Kit",
"4007503-200 2" Check valve",
"90 degree flange to hose barb 2"",
"116500-250 Rightspot Solenoid",
"4004671-12 InCommand Display Cable w/Ethernet (12ft)",
"4004399 Incommand Legacy Adapter",
"4004269-12 Incommand Display Cable w/o Ethernet",
"4002506-12 Integra Display Cable with ISOBUS",
"4001608-12 Integra Display Cable w/o ISOBUS",
"JD2COC JD 2 Camera input adapters",
"AgLeader Integra 4 input",
"DMAC-CT AgCam 5 pin to 3 Pin adapter",
"EC10 AgCam extension 10ft",
"EC40 AgCam Extension 40ft",
"EC20 Overview Extension 20ft",
"DMAC-OVM AgCam to Overview",
"Overview Number Overview Camera",
"DMAC-OVC Overview to AgCam adapter",
"4005560-12 InCommand Aux Serial , 2 Camera",
"4005505-12 InCommand Aux Serial",
"4007300 Br1 Mini Power New Style",
"4005136 Br1 mini Power Old style",
"4004175-18 GPS 6000/6500 Dual Port",
"4004341-2 GPS 6000/6500 Dual Port Bulkhead",
"4100992 GPS 6000/7000 Plate",
"4004173-18 GPS 6000/6500 Single Port",
"GPS 6000/6500 Dual Port Bulkhead chasis",
"4100993 GPS 6500 Plate",
"4005622 GPS 7500 Plate",
"GPS 6000 No Peg Plate",
"4001403-6 Dickey-John Adapter",
"4001534 JD CT350 adapter",
"4002806-12 ISOBUS ext 12ft",
"4001533-6 JD CT250 Adapter",
"4000953-25 Fan Speed Cable",
"AE3123J JD Air Drill Adapter to CT AgExpress",
"4001301 Kinze Breakout",
"4000724-6 Implement Externsion 6ft",
"4000724-12 Implement Extension 12ft",
"4000724-24 Implement Extension 24 ft",
"4000724-36 Implement Extension 36ft",
"4001979-3 CAN Power Cable 3ft",
"4001979-12 CAN Power Cable 12ft",
"4000726-12 Implement Cable Dual Module 12ft",
"4001507 Whisker Switch",
"4101423 Implement Switch kit- Kinze (3000)",
"4101420 Implement Switch kit- JD(Max Emerge)",
"4101491 Implement Switch Kit-JD Max Emerge",
"4001391 Implement Tee 2 input",
"4001390 Implement Tee 1 input",
"4005770 Puch button Implement Switch",
"4002658 CAN Implement Tee harness",
"4005971 Old style Implement module",
"2000453-2 Header Extension 10ft",
"2000453-3 Header Extension 25ft",
"2000453-1 Header Extension 4ft",
"4005036-006 JD WAS adapter w/ term",
"201-0563-01 Remote Engage, CAN Steering (1ft)",
"4002726-2 Hagie Steering Harness",
"201-0605-02 ECU Main Harness",
"201-0603-01 MDU Cable",
"201-0512-02 Steercommand Legacy Valve Cable",
"201-0485-01 SPX Valve Adapter",
"201-0475-01 Paradyme power relay",
"201-0447-01 Ontrac2 CAN",
"4004541-4 Cable-SCM Power 1/0, REV D (4ft)",
"4006375-16 Ethernet 5.0M",
"4002140 Remote Engage Extension Cable (6ft)",
"4005073-6 Intellisteer Term Kit",
"4005442-2 Hagie Interface Cable STS Steer Ready",
"4004635-12 Ethernet M12- RJ45",
"Top ring -02",
"Top ring -03",
"4100163 Footpedal",
"4006107-12 MDU Cables",
"4200207 Steadysteer gear",
"4005114 Remote engage adapter",
"4002026-15 Battery Cable power and Guidance only 15ft",
"4002016-15 Battery Power w/ Hi current 15ft",
"4002016-12 Battery Power w/ Hi current 12ft",
"4000739-12 Multi-module Power Cable 12ft",
"4002016-22 Battery Power w/ Hi current 22ft",
"4002025-5 power cable",
"4000411-12 Power Cable Old Style 12ft",
"4006140 SC110 Breakout",
"4000218-1 CANBUS Line 1 ft",
"4000218-3 CANBUS Line 3 ft",
"4000450 CANBUS Stub",
"4000218-6 CANBUS Line 6 ft",
"4000218-2 CANBUS Stub 2ft",
"4001470-8 Jump Start Cable",
"Iso Splitter",
"4004301 Incommand ISO Adapt",
"4002587 Active Term",
"4005236-8 Incommand IBBC Tee",
"Serial Extensions",
"4000522-18 GPS 5100 18ft",
"AE3070B John Deere Adapter",
"4002673-18 GPS 1500/2500 Single port (18fr)",
"4003263-6 Geosteer NMEA out",
"4000325-10 PC Null Modem 10ft",
"DOM2923 Nav to AgLeader Adapter",
"BR-355N Truesight Speed Puck",
"4000277 Power Tee Cable",
"4000236-1 Header Height Adapter",
"300920-1 Power Cable 4 ft",
"2000930 Battery Power Cable",
"2000405 JD 9x00 Power",
"2000909-2 Power E.M.S",
"2000909-3 Power E.M.S",
"4000353-13 Ground Speed DT",
"4000235-16 Ground Speed WP",
"2000404 Power Jump JD 9x00",
"4001970-14 Ground Speed DT triangle",
"4000234-10 Elevator Speed WP",
"4000234-29 Elevator Speed WP",
"4001605-1 Moisture Sensor Adapter",
"4000353-16 Ground Speed DT",
"4002061-15 Moisture CNH to AGL",
"4000354-3 CAN Kit for 88 series Case",
"4000354-2 CAN Kit for 10 series Case",
"4000356-4 CAN Kit for JD 9x00-9x10",
"4000326-1 CAN Kit for Case 2000+",
"4004804-29 Elevator Speed Metro",
"4000220-1 Moisture Module Stub",
"2000404 Power Jumper 9400",
"2000405 Power Cable 9400-9600",
"4000235-18 Ground Speed Cable",
"2000908-1 RH Motor",
"4001538 Moisture Module",
"4001539-3 EMU Control Cable",
"Moisture module mounts",
"2000907 Proximity Alum",
"3000407 Proximity Plastic",
"2001351 JD Wear Sheet",
"3001947 PF3000 Battery Replacement",
"2000411-1 Moisture Sensor Old",
"4005762 GPS 7500 Bracket",
"4000325-10 PC Null Modem (10ft)",
"AE2640 Radar Speed to 4pin round",
"AE3380 Nav to Ag Adapter",
"40004342-12 GPS 6000/6500 Cable",
"4004173-18 GPS 7500 Single Port",
"4003263-6 Geosteer NMEA (6ft)",
"4003263-006 NMEA Out",
"Speed Puck For Headsight",
"200986 Adapter Port 1 to Aux 1",
"4004176-18 GPS 6000/6500 Moble Logging",
"4004342-12 GPS 6000/6500 Chassis",
"3000474 GPS 1000 Cable",
"4002226-15 ParaDyme Auxillary Cable",
"4004175-18 GPS 7500 Dual Port",
"Nav to Agleader",
"4100992 GPS 6000 bracket",
"4002506-12 Integra display Cable ISOBus",
"4001608-12 Integra Display cable non iso",
"4004269-12 InCommand Display Cable (12ft)",
"4002016-22 High Curren Power Cable (22f)",
"4000752-12 Multiple Module Power (12ft)",
"4006395 Battery to Battery Power 24V",
"JD Power Bank Adapter",
"40027002-7 Display Cable CAN A",
"4007687-12 Incommand V2 (12ft)",
"4007789-15 Incommand V2/ Guidance (15ft)",
"4006352-3 CAN/Power Cable (3ft)",
"4000726-3 Ipmlement Cable Dual Module (3ft)",
"4002585-10 Cable ISOBUS/Power control (10ft)",
"4003118-008 CAN B to 6Pin ISOBUS (8inch)",
"4002631 AGCO ISO hijack",
"4001047 Second Module CAN stub",
"400450-1 Implement Module Stub",
"4000724-24 Implement Ext (24ft)",
"4006350-12 CAN Implement Cable (12ft)",
"4004876-6 Local CANBUS Ext 6 ft",
"4000724-36 Implement Ext (36ft)",
"4004311-4 Row Unit CAN bus Breakout",
"4001779 Clutch Control 16 rows 2 sec",
"4001746 Clutch Control 16 row 1 sec",
"4001778 Clutch Control 12 row 2 sec",
"4001391-1 Implement switch tee",
"4005702 PCM I/O Power Adapter",
"4001451 Norac CAN Cable",
"4000527-5 OEM Switch Cable 5ft",
"4002209-6 Main Aux Valve",
"4000510-5 LPCM Switch Cable",
"4001633-6 Accuboom Flow Control Valve Cable",
"4000519-2 Adapter Cable",
"4000851-3 Direct Injection Cable",
"4003966-1 Hagie Adapter to Raven 4x10 Harness",
"4001817-1 SPX 4420 ADAPTER (MY 2008)",
"4001636 Accu-Flow ON/OFF",
"A12596 Radar Cable",
"4000949 Raven Adapter 4400",
"4000596-5 cable switch",
"4001452-2 Norac Power Cable",
"4001635 Accuboom flow control valve adapter",
"4001916 7 boom section adapter cable",
"201-2737y1 Surefire imp switch adapter",
"Pump Switch",
"4006975-006 Adapter 3pos to 3pos MP",
"4003701-006 Raven Valve Adapter",
"4003702-006 Raven Flow Meter Adapter",
"4000320-6 Cig Power",
"200-0155-02 Linkage generic",
"br1 Mini service unit",
"Potentiameter",
"Wheel angle sensor block",
"730517 Bulk fill adapter 1.25in",
"Ethernet Cable Blue",
"GPS 6500 Programing Cable",
"4003814-6 Compass Display Cable (6ft)",
"0.01 Top Ring",
"0.02 Top Ring",
"0.03 Top Ring",
"0.04 Top Ring",
"4004933 Universal Seat Bracket",
"4005142 JD Combine Seat Mount",
"4100163-2 Remote Engage Console Switch",
"4000279 5in RAM Arm",
"4000187 2x6 RAM Base",
"4000281 RAM Bar Mount",
"4001492 2in RAM Arm",
"4000454 12in RAM Arm",
"4000280 RAM Monitor Mount",
"RAM 1in Ball Arm",
"RAM 1in Ball Base",
"2001352-1 Hardware Kit Switch Console",
"202047607 JD W bracket",
"201-0620-01 Vehicle CAN Massey",
"201-0566-01 Plug",
"YC Cable 1920",
"TS - GPS",
"DMAC - OVM",
"Overview Extention (10ft)",
"BR1 Mini Mounting"
    ];
    function addProduct() {
      if (productCount >= 10) return alert("Max 10 products allowed");
      const div = document.createElement("div");
      div.className = "product-group";
      div.innerHTML = `
        <label>Part # / Product Name:
          <input name="product${productCount}" required list="productList">
        </label>
        <label>Quantity:
          <select name="qty${productCount}" required>
            ${[...Array(10)].map((_, i) => `<option>${i + 1}</option>`).join('')}
          </select>
        </label>
      `;
      document.getElementById("product-list").appendChild(div);
      productCount++;
    }

    // Initial product row
    addProduct();
const datalist = document.createElement("datalist");
datalist.id = "productList";

productList.forEach(item => {
  const option = document.createElement("option");
  option.value = item;
  datalist.appendChild(option);
});

document.body.appendChild(datalist);

    document.getElementById("checkout-form").addEventListener("submit", async function (e) {
      e.preventDefault();
      const form = e.target;
      const data = new FormData(form);
      const payload = {
        timestamp: new Date().toISOString(),
        location: data.get("location"),
        customer: data.get("customer"),
        technician: data.get("technician"),
        products: []
      };

      for (let i = 0; i < productCount; i++) {
        const name = data.get(`product${i}`);
        const qty = data.get(`qty${i}`);
        if (name && qty) {
          payload.products.push({ name, qty });
        }
      }

      // Call your Apps Script Web App endpoint here
      try {
        const res = await fetch("https://script.google.com/macros/s/AKfycbzfkv59TACVtAjWJ5lOtK-slFHxIreP4Yd5fx2iKmXGJo97i9ELm2_e4PMVk3UxiJDf/exec", {
          method: "POST",
          mode: "no-cors",
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });
        alert("Submission sent!");
        form.reset();
        document.getElementById("product-list").innerHTML = "";
        productCount = 0;
        addProduct();
      } catch (err) {
        alert("Submission failed.");
      }
    });
  </script>
</body>
</html>
